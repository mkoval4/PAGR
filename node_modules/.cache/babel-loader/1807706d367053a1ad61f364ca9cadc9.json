{"ast":null,"code":"import indexOf from 'lodash/indexOf';\nimport lastIndexOf from 'lodash/lastIndexOf';\nimport range from 'lodash/range';\nimport includes from 'lodash/includes';\nimport isNil from 'lodash/isNil';\nimport isArray from 'lodash/isArray';\nimport concat from 'lodash/concat';\nimport uniq from 'lodash/uniq';\nimport first from 'lodash/first';\nimport sortBy from 'lodash/sortBy';\nimport slice from 'lodash/slice';\nimport find from 'lodash/find';\n/** Build days to fill page. */\n\nexport function buildDays(date, daysOnPage) {\n  var start = date.clone().startOf('month').startOf('week');\n  return getDaysArray(start.date(), getBrakepoints(date), daysOnPage).map(function (d) {\n    return d.toString();\n  });\n}\n/** Return dates from ends of months.\r\n *\r\n * On one datepicker's page not only days from current month are displayed\r\n * but also some days from adjacent months. This function returns days\r\n * that separate one month from other (last day in month).\r\n * Return array of one or two numbers.\r\n */\n\nfunction getBrakepoints(referenceDate) {\n  var dateInCurrentMonth = referenceDate.clone();\n  var currentMonth = dateInCurrentMonth.month();\n  var brakepoints = [];\n  var firstDateOnPage = dateInCurrentMonth.clone().startOf('month').startOf('week');\n\n  if (firstDateOnPage.month() !== currentMonth) {\n    brakepoints.push(firstDateOnPage.clone().endOf('month').date());\n  }\n\n  brakepoints.push(dateInCurrentMonth.clone().endOf('month').date());\n  return brakepoints;\n}\n/* Return array of day positions that are not disabled by default. */\n\n\nexport function getDefaultEnabledDayPositions(allDays, date) {\n  var dateClone = date.clone();\n  var brakepoints = getBrakepoints(dateClone);\n\n  if (brakepoints.length === 1) {\n    return range(0, indexOf(allDays, brakepoints[0].toString()) + 1);\n  } else {\n    return range(indexOf(allDays, brakepoints[0].toString()) + 1, lastIndexOf(allDays, brakepoints[1].toString()) + 1);\n  }\n}\n/** Return day positions that shoud be displayed as disabled. */\n\nexport function getDisabledDays(disable, maxDate, minDate, currentDate, daysOnPage, enable) {\n  var dayPositions = range(daysOnPage);\n  var daysInCurrentMonthPositions = getDefaultEnabledDayPositions(buildDays(currentDate, daysOnPage), currentDate);\n  var disabledDays = dayPositions.filter(function (dayPosition) {\n    return !includes(daysInCurrentMonthPositions, dayPosition);\n  });\n\n  if (isArray(enable)) {\n    var enabledDaysPositions_1 = enable.filter(function (date) {\n      return date.isSame(currentDate, 'month');\n    }).map(function (date) {\n      return date.date();\n    }).map(function (date) {\n      return daysInCurrentMonthPositions[date - 1];\n    });\n    disabledDays = concat(disabledDays, dayPositions.filter(function (position) {\n      return !includes(enabledDaysPositions_1, position);\n    }));\n  }\n\n  if (isArray(disable)) {\n    disabledDays = concat(disabledDays, disable.filter(function (date) {\n      return date.isSame(currentDate, 'month');\n    }).map(function (date) {\n      return date.date();\n    }).map(function (date) {\n      return daysInCurrentMonthPositions[date - 1];\n    }));\n  }\n\n  if (!isNil(maxDate)) {\n    if (maxDate.isBefore(currentDate, 'month')) {\n      disabledDays = dayPositions;\n    }\n\n    if (maxDate.isSame(currentDate, 'month')) {\n      disabledDays = concat(disabledDays, range(1, daysInCurrentMonthPositions.length + 1).filter(function (date) {\n        return date > maxDate.date();\n      }).map(function (date) {\n        return daysInCurrentMonthPositions[date - 1];\n      }));\n    }\n  }\n\n  if (!isNil(minDate)) {\n    if (minDate.isAfter(currentDate, 'month')) {\n      disabledDays = dayPositions;\n    }\n\n    if (minDate.isSame(currentDate, 'month')) {\n      disabledDays = concat(disabledDays, range(1, daysInCurrentMonthPositions.length + 1).filter(function (date) {\n        return date < minDate.date();\n      }).map(function (date) {\n        return daysInCurrentMonthPositions[date - 1];\n      }));\n    }\n  }\n\n  return sortBy(uniq(disabledDays).filter(function (day) {\n    return !isNil(day);\n  }));\n}\n/** Return day positions that should be displayed as marked. */\n\nexport function getMarkedDays(marked, currentDate, daysOnPage) {\n  if (marked.length === 0) {\n    return [];\n  }\n\n  var allDates = buildDays(currentDate, daysOnPage);\n  var activeDayPositions = getDefaultEnabledDayPositions(allDates, currentDate);\n  var allDatesNumb = allDates.map(function (date) {\n    return parseInt(date, 10);\n  });\n  /*\r\n   * The following will clear all dates before the 1st of the current month.\r\n   * This is to prevent marking days before the 1st, that shouldn't be marked.\r\n   * If the incorrect dates are marked, instead of the legitimate ones, the legitimate dates\r\n   * will not be marked at all.\r\n  */\n\n  var fillTo = allDatesNumb.indexOf(1);\n\n  for (var i = 0; i < fillTo; i++) {\n    allDatesNumb[i] = 0;\n  }\n\n  var markedIndexes = marked.filter(function (date) {\n    return date.isSame(currentDate, 'month');\n  }).map(function (date) {\n    return date.date();\n  }).map(function (date) {\n    return allDatesNumb.indexOf(date);\n  });\n  return markedIndexes.filter(function (index) {\n    return includes(activeDayPositions, index);\n  });\n}\nexport function isNextPageAvailable(date, maxDate) {\n  if (isNil(maxDate)) {\n    return true;\n  }\n\n  if (date.isSameOrAfter(maxDate, 'month')) {\n    return false;\n  }\n\n  return true;\n}\nexport function isPrevPageAvailable(date, minDate) {\n  if (isNil(minDate)) {\n    return true;\n  }\n\n  if (date.isSameOrBefore(minDate, 'month')) {\n    return false;\n  }\n\n  return true;\n} // helper\n\nfunction getDaysArray(start, brakepoints, length) {\n  var currentDay = start;\n  var days = [];\n  var brakepointsLeft = brakepoints.slice();\n\n  while (!(days.length === length)) {\n    days.push(currentDay);\n    var bp = first(brakepointsLeft);\n\n    if (currentDay === bp) {\n      currentDay = 1;\n      brakepointsLeft = slice(brakepointsLeft, 1);\n    } else {\n      currentDay = currentDay + 1;\n    }\n  }\n\n  return days;\n}\n\nexport var testExport = {\n  buildDays: buildDays,\n  getBrakepoints: getBrakepoints,\n  getDisabledDays: getDisabledDays,\n  isNextPageAvailable: isNextPageAvailable,\n  isPrevPageAvailable: isPrevPageAvailable,\n  getDaysArray: getDaysArray,\n  getDefaultEnabledDayPositions: getDefaultEnabledDayPositions\n};\nexport function getInitialDatePosition(initDate, values, selectablePositions) {\n  var selectable = selectablePositions.reduce(function (acc, pos) {\n    acc.push({\n      value: values[pos],\n      position: pos\n    });\n    return acc;\n  }, []);\n  var res = find(selectable, function (item) {\n    return item.value === initDate;\n  });\n\n  if (res) {\n    return res.position;\n  }\n\n  return selectable[0].position;\n}","map":null,"metadata":{},"sourceType":"module"}